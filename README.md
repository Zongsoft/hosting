## éƒ¨ç½²

å®¿ä¸»ç¨‹åºåªè´Ÿè´£åˆå§‹åŒ–è¿è¡Œæ—¶çŽ¯å¢ƒï¼Œä½œä¸ºæ’ä»¶çš„æ‰¿è½½å®¹å™¨å…¶è‡ªèº«å¹¶ä¸å«æœ‰å…·ä½“çš„åŠŸèƒ½å®žçŽ°ï¼Œæˆ‘ä»¬é€šè¿‡å°†éœ€è¦çš„æ’ä»¶åŠå…¶ç›¸å…³é™„å±ž(é…ç½®ã€è¯ä¹¦)æ–‡ä»¶æ”¾ç½®åœ¨ `plugins` ç›®å½•ä¸‹çš„ç›¸åº”å­ç›®å½•ä¸­ï¼Œè¿™ä¸ªè¡Œä¸ºå³ä¸ºéƒ¨ç½²ã€‚

è¿è¡Œ `deploy.cmd` _(**W**indows)_ æˆ– `deploy.sh` _(**L**inux/**U**nix)_ è„šæœ¬ä»¥æ‰§è¡Œç”±éƒ¨ç½²æ–‡ä»¶ _(`*.deploy`)_ æ‰€å®šä¹‰çš„éƒ¨ç½²å†…å®¹ã€‚

> æç¤ºï¼šéƒ¨ç½²è„šæœ¬ä¾èµ– **Z**ongsoft.**T**ools.**D**eployer å·¥å…·è¿›è¡Œéƒ¨ç½²æ“ä½œï¼Œæœ‰å…³è¯¥å·¥å…·çš„ä½¿ç”¨è¯´æ˜Žï¼Œè¯·å‚è€ƒå…¶å¼€æºé¡¹ç›®çš„ç›¸å…³æ–‡æ¡£ï¼š
> - è‹±æ–‡ï¼š[https://github.com/Zongsoft/Zongsoft.Tools.Deployer/blob/master/README.md](https://github.com/Zongsoft/Zongsoft.Tools.Deployer/blob/master/README.md)
> - ä¸­æ–‡ï¼š[https://github.com/Zongsoft/Zongsoft.Tools.Deployer/blob/master/README-zh_CN.md](https://github.com/Zongsoft/Zongsoft.Tools.Deployer/blob/master/README-zh_CN.md)

### éƒ¨ç½²æ–‡ä»¶

é€šå¸¸é…ç½®æ–‡ä»¶ä¸Žç‰¹å®šçš„ **äº§å“**ã€**é¡¹ç›®**ã€**éƒ¨ç½²å¹³å°** _ï¼ˆå¦‚ï¼šå•æœºã€å†…ç½‘ã€ç§æœ‰äº‘ã€å…¬æœ‰äº‘ï¼‰_ åŠ **çŽ¯å¢ƒ** _ï¼ˆå¦‚ï¼šå¼€å‘ã€æµ‹è¯•ã€ç”Ÿäº§ï¼‰_ ç­‰ç›¸å…³ï¼Œæ‰€ä»¥åº”è¯¥å°†è¿™äº›ç‰¹å®šç›¸å…³æ€§çš„æ–‡ä»¶å•ç‹¬å­˜æ”¾åœ¨ `/hosting/.deploy` ç›®å½•ä¸‹ï¼Œä»¥ä¾¿äºŽç»Ÿä¸€ç®¡ç†ä¸Žç»´æŠ¤ã€‚

> æç¤ºï¼šæ›´å¤šéƒ¨ç½²é¡¹çš„ç”¨æ³•è¯·å‚è€ƒå®¿ä¸»ç¨‹åºç›®å½•ä¸­çš„ `.deploy` éƒ¨ç½²æ–‡ä»¶ã€‚

#### é…ç½®æ–‡ä»¶

åº”è¯¥æ ¹æ®é…ç½®å†…å®¹çš„çŽ¯å¢ƒç›¸å…³æ€§æ¥å®šä¹‰é…ç½®æ–‡ä»¶ï¼Œç›¸åº”çš„çŽ¯å¢ƒåä½œä¸ºé…ç½®æ–‡ä»¶åçš„å°¾éƒ¨ã€‚ä¸‹é¢ä»¥ **Zongsoft.Security** æ’ä»¶çš„é…ç½®æ–‡ä»¶ä¸ºä¾‹è¿›è¡Œè¯´æ˜Žï¼š

- `Zongsoft.Security.option`
	> è¡¨ç¤ºçŽ¯å¢ƒæ— å…³çš„é…ç½®æ–‡ä»¶ï¼Œå…¶é…ç½®ä½œä¸ºå…¶ä»–çŽ¯å¢ƒæœ‰å…³æ€§é…ç½®çš„ç¼ºçœå€¼ï¼›
-----
- `Zongsoft.Security.test.option`
	> è¡¨ç¤º**æµ‹è¯•çŽ¯å¢ƒ**æœ‰å…³çš„é…ç½®æ–‡ä»¶ï¼Œè­¬å¦‚è¯¥é…ç½®æ–‡ä»¶å†…çš„æ•°æ®åº“è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘çš„æ˜¯**æµ‹è¯•æ•°æ®åº“**å¹¶ä¸”ä½¿ç”¨çš„æ˜¯**å†…ç½‘åœ°å€**ç­‰ã€‚
- `Zongsoft.Security.production.option`
	> è¡¨ç¤º**ç”Ÿäº§çŽ¯å¢ƒ**æœ‰å…³çš„é…ç½®æ–‡ä»¶ï¼Œè­¬å¦‚è¯¥é…ç½®æ–‡ä»¶å†…çš„æ•°æ®åº“è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘çš„æ˜¯**ç”Ÿäº§æ•°æ®åº“**å¹¶ä¸”ä½¿ç”¨çš„æ˜¯**å†…ç½‘åœ°å€**ç­‰ã€‚
- `Zongsoft.Security.development.option`
	> è¡¨ç¤º**å¼€å‘çŽ¯å¢ƒ**æœ‰å…³çš„é…ç½®æ–‡ä»¶ï¼Œè­¬å¦‚è¯¥é…ç½®æ–‡ä»¶å†…çš„æ•°æ®åº“è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘çš„æ˜¯**å¼€å‘æ•°æ®åº“**å¹¶ä¸”ä½¿ç”¨çš„æ˜¯**å†…ç½‘åœ°å€**ç­‰ã€‚
-----
- `Zongsoft.Security.test-debug.option`
	> è¡¨ç¤º**æµ‹è¯•çŽ¯å¢ƒ**æœ‰å…³çš„é…ç½®æ–‡ä»¶ï¼Œè­¬å¦‚è¯¥é…ç½®æ–‡ä»¶å†…çš„æ•°æ®åº“è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘çš„æ˜¯**æµ‹è¯•æ•°æ®åº“**å¹¶ä¸”ä½¿ç”¨çš„æ˜¯**å¤–ç½‘åœ°å€**ç­‰ã€‚
- `Zongsoft.Security.production-debug.option`
	> è¡¨ç¤º**ç”Ÿäº§çŽ¯å¢ƒ**æœ‰å…³çš„é…ç½®æ–‡ä»¶ï¼Œè­¬å¦‚è¯¥é…ç½®æ–‡ä»¶å†…çš„æ•°æ®åº“è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘çš„æ˜¯**ç”Ÿäº§æ•°æ®åº“**å¹¶ä¸”ä½¿ç”¨çš„æ˜¯**å¤–ç½‘åœ°å€**ç­‰ã€‚
- `Zongsoft.Security.development-debug.option`
	> è¡¨ç¤º**å¼€å‘çŽ¯å¢ƒ**æœ‰å…³çš„é…ç½®æ–‡ä»¶ï¼Œè­¬å¦‚è¯¥é…ç½®æ–‡ä»¶å†…çš„æ•°æ®åº“è¿žæŽ¥å­—ç¬¦ä¸²æŒ‡å‘çš„æ˜¯**å¼€å‘æ•°æ®åº“**å¹¶ä¸”ä½¿ç”¨çš„æ˜¯**å¤–ç½‘åœ°å€**ç­‰ã€‚

### ç›®å½•ç»“æž„

ä½äºŽ `hosting` ç›®å½•ä¸‹çš„ `.deploy` ç›®å½•å³ä¸ºå­˜æ”¾éƒ¨ç½²ç›¸å…³çš„å„ç§èµ„æºçš„â€˜æ ¹â€™ç›®å½•ï¼Œå…¶ä¸‹çº§ç»“æž„å¦‚ä¸‹ï¼š

- `certificates` è¯ä¹¦æ–‡ä»¶ç›®å½•
	> æ³¨ï¼šéƒ¨ç½²å¹³å°æ— å…³çš„è¯ä¹¦æ–‡ä»¶ã€‚

- `{scheme}` éƒ¨ç½²æ–¹æ¡ˆ
	- `certificates` è¯ä¹¦æ–‡ä»¶ç›®å½•
		> æ³¨ï¼šä¸Žéƒ¨ç½²æ–¹æ¡ˆæœ‰å…³è”çš„è¯ä¹¦æ–‡ä»¶ã€‚
	- `options` é…ç½®æ–‡ä»¶ç›®å½•

### éƒ¨ç½²å·¥å…·

åœ¨è¿è¡Œ `deploy.cmd` è„šæœ¬ä¹‹å‰å¿…é¡»ç¡®ä¿ `deploy` å·¥å…·å·²ç»å®‰è£…ï¼Œå¯é€šè¿‡ä¸‹é¢å‘½ä»¤æŸ¥çœ‹å·²å®‰è£…çš„å…¨å±€å·¥å…·ï¼š
```bash
dotnet tool list -g
```

å¦‚æžœå°šæœªå®‰è£… `deploy` å·¥å…·ï¼Œå¯é€šè¿‡ä¸‹é¢å‘½ä»¤è¿›è¡Œå…¨å±€å®‰è£…ï¼š
```bash
dotnet tool install -g zongsoft.tools.deployer
```

å¦‚æžœå·²ç»å®‰è£…äº† `deploy` å·¥å…·ï¼Œå¯é€šè¿‡ä¸‹é¢å‘½ä»¤è¿›è¡Œå‡çº§æ›´æ–°ï¼š
```bash
dotnet tool update -g zongsoft.tools.deployer
```

> æœ‰å…³ **Z**ongsoft.**T**ools.**D**eployer éƒ¨ç½²å·¥å…·çš„æ›´å¤šå†…éƒ¨åŽŸç†ä¸Žå®žçŽ°ï¼Œè¯·è®¿é—®è¯¥é¡¹ç›®çš„å¼€æºç½‘å€ï¼š[https://github.com/Zongsoft/Zongsoft.Tools.Deployer](https://github.com/Zongsoft/Zongsoft.Tools.Deployer)


## å®¹å™¨åŒ–

ç”±äºŽä¸€äº›æ’ä»¶éœ€è¦ä½¿ç”¨åˆ° _**R**edis_ã€_**M**y**SQL**_ æˆ– _**P**ostgre**SQL**_ æ•°æ®åº“ç­‰ï¼Œå› æ­¤å¯ä»¥ä½¿ç”¨å®¹å™¨åŒ–è¿™äº›ä¾èµ–çš„æœåŠ¡ã€‚

> å»ºè®®å®‰è£… _**P**odman_ _**CLI**_ è¿›è¡Œå®¹å™¨åŒ–å¤„ç†ï¼Œä¸‹é¢æ˜¯å®ƒçš„å®‰è£…ç¨‹åºåœ°å€ï¼š
> - https://podman.io
> - https://github.com/containers/podman/releases

> ðŸ’¡ å¦‚æžœæ˜¯ _**W**indows_ çŽ¯å¢ƒï¼Œè¯·ç¡®ä¿å®‰è£…äº† WSL-2ã€‚å‚è€ƒï¼šhttps://learn.microsoft.com/zh-cn/windows/wsl/install


æˆ‘ä»¬å‡†å¤‡äº†ä¸€ä¸ªåä¸º [_zongsoft.pod.yaml_](./zongsoft.pod.yaml) çš„ _**P**od_ æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶å®šä¹‰äº† _**R**edis_ å’Œ _**M**ySQL_ ä¸¤ä¸ªå®¹å™¨å’Œä¸€ä¸ªåä¸º `zongsoft` æ•°æ®åº“ï¼Œç¡®ä¿å¼€ç®±å³ç”¨ã€‚

> ðŸ’¡ è¯·ç¡®ä¿åœ¨ [_hosting_](https://github.com/Zongsoft/hosting) åŒçº§è·¯å¾„ä¸­æœ‰ [adadministratives](https://github.com/Zongsoft/administratives) ä»“åº“å’Œ [framework](https://github.com/Zongsoft/framework) ä»“åº“ï¼Œå› ä¸º `zongsoft` æ•°æ®åº“åˆ›å»ºåŽä¼šåŠ è½½è¿è¡Œè¿™ä¸¤ä¸ªä»“åº“ä¸­çš„ _SQL_ è„šæœ¬ï¼Œä»¥å®Œæˆå»ºè¡¨å’Œæ•°æ®åˆå§‹åŒ–ã€‚

### æ“ä½œæ­¥éª¤

1. æ‰“å¼€ _**P**ower**S**hell_ ç»ˆç«¯ï¼Œä½¿ç”¨å¦‚ä¸‹å‘½ä»¤è¿è¡Œæˆ‘ä»¬å‡†å¤‡å¥½çš„ _Pod_ å®¹å™¨
```powershell
podman kube play --replace .\zongsoft.pod.yaml
```

2. ä½¿ç”¨ä¸‹åˆ—å‘½ä»¤æ£€æŸ¥ _Pod_ æ˜¯å¦æˆåŠŸè¿è¡Œ
> ðŸ’¡ å¦‚æžœæˆåŠŸåˆ™ç¨ç­‰ä¸€ä¼šå†è¿žæŽ¥æ•°æ®åº“ï¼Œå› ä¸ºå®¹å™¨åŠ è½½åŽä¼šè‡ªåŠ¨åˆ›å»ºä¾èµ–çš„æ•°æ®åº“è¡¨å’Œåˆå§‹åŒ–æ•°æ®ã€‚

```powershell
podman pod ps
podman ps --pod -a
```

> å¦‚æžœå¯åŠ¨å¤±è´¥ï¼Œå¯é€šè¿‡ä¸‹åˆ—å‘½ä»¤æŸ¥çœ‹æ—¥å¿—
> ```powershell
> podman logs zongsoft.mysql
> podman logs zongsoft.redis
> ```
